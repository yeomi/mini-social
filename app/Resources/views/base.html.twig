<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>{% block title %} - Tpaschiche - {% endblock %}</title>
        {% block stylesheets %}
            <meta name="MobileOptimized" content="width">
            <meta name="HandheldFriendly" content="true">
            <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1">

            <link rel="stylesheet" href="{{ asset("assets/css/global.css") }}"/>
            <link rel="stylesheet" href="{{ asset("assets/css/libs/slick.css") }}"/>
        {% endblock %}
        <link rel="icon" type="image/x-icon" href="{{ asset('favicon.png') }}" />
    </head>
    <body>
        {% block jsPlugin %}{% endblock %}

        <div id="status-message">
            <div class="check-cookie-fail hide alert">
                <p>Les cookies ne sont pas activés sur votre navigateur.
                    Veuillez les activer dans les préférences de votre navigateur pour pouvoir vous connecter</p>
            </div>
        {% block statusMessage %}
            {% for index, message in app.session.flashbag.get("info") %}
                <div class="info flash"><p>{{ message }}</p></div>
            {% endfor %}
            {% for index, message in app.session.flashbag.get("alert") %}
                <div class="alert"><p>{{ message }}</p></div>
            {% endfor %}
        {% endblock %}
        </div>

        {% set unreadMessage = render(controller("YeomiUserBundle:Profile:checkUnreadMessage")) %}

        {% block popups %}
            {{ render(controller("YeomiPostBundle:Main:menu")) }}
        {% if is_granted("IS_AUTHENTICATED_REMEMBERED") == false %}
            {{ render(controller("YeomiUserBundle:Main:login")) }}
        {% else %}
            {{ render(controller("YeomiUserBundle:Main:userPanel", {"unreadMessages": unreadMessage})) }}
        {% endif %}
            {{ render(controller("YeomiPostBundle:Main:addPost", {"type": "defi"})) }}
            {{ render(controller("YeomiPostBundle:Main:addPost", {"type": "histoire"})) }}
        {% endblock %}

        {% block header %}
            <div class="wrapper-width site-header">
                <header id="site-header">
                {% block menu_left %}
                    <nav class="main-nav left">
                        <ul>
                            <li><a href="" class="menu-toggle">☰</a></li>
                            <li class="site-search-container">
                                <form class="site-search" action="{{ path("yeomi_post_search") }}" method="post">
                                    <a href="" class="btn search">{% trans %}Search{% endtrans %}</a>
                                    <input type="text" placeholder="Tapez une recherche" name="site_search"/>
                                    <input type="submit" value="Ok"/>
                                </form>
                            </li>
                            {% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
                                <li class="unread-messages-container">
                                    <a class="log-btn btn-light yeomi-popup-link logged" data-popup="user-panel" href="{{ url("logout") }}">{{ app.user.username }}</a>
                                    {% if unreadMessage > 0 %}
                                        <span class="unread-messages">{{ unreadMessage }}</span>
                                    {% endif %}
                                </li>
                            {% else %}
                                <li><a class="log-btn btn-light login yeomi-popup-link" data-popup="login" {{ url("login") }}">{% trans %}Login{% endtrans %}</a></li>
                            {% endif %}
                        </ul>
                    </nav>
                {% endblock %}

                {% block logo %}
                    <a id="main-logo" href="{{ url("yeomi_post_index") }}">
                        <img src="{{ asset('assets/img/main-logo.png') }}" alt="Tpaschiche"/>
                    </a>
                {% endblock %}

                {% block menu_right %}
                    <nav class="main-nav right">
                        <span class="mobile-btn"></span>
                        <ul>
                            <li><a class="btn new-challenge add-btn yeomi-popup-link" data-popup="add-defi" href="{{ url("yeomi_post_add_post", {"type": "defi"}) }}">{% trans %}Suggest a challenge{% endtrans %}</a></li>
                            <li><a class="btn new-story add-btn yeomi-popup-link" data-popup="add-histoire" href="{{ url("yeomi_post_add_post", {"type": "histoire"}) }}">{% trans %}Share a story{% endtrans %}</a></li>
                        </ul>
                    </nav>
                {% endblock %}
                </header>
            </div>
        {% endblock %}



        {% block body %}{% endblock %}

        {% block footer %}
            <div class="sentence-footer">
            </div>

            <footer id="site-footer">
                <nav class="footer-nav">
                    {{ render(controller("YeomiCMSBundle:Main:getListOfPage")) }}
                </nav>
                {# can be taken out on the next dev
                <nav class="sub-footer-nav">
                    <ul class="left">
                        <li><a href="#">Faire une publication</a></li>
                        <li><a href="{{ path("yeomi_user_register") }}">Inscription rapide</a></li>
                    </ul>
                </nav>
                #}
            </footer>
        {% endblock %}
        {% block javascripts %}

            <script src="{{ asset("assets/js/libs/jquery-1.11.2.js") }}"></script>
            <script src="{{ asset("bundles/yeomipost/js/script.js") }}"></script>
            <script src="{{ asset("bundles/yeomiuser/js/script.js") }}"></script>
            <script src="{{ asset("bundles/yeomipost/js/vote.js") }}"></script>
            <script src="{{ asset("assets/js/script.js") }}"></script>
            <script src="{{ asset("assets/js/libs/slick.min.js") }}"></script>
            <script src="{{ asset("assets/js/responsive.js") }}"></script>
        {% endblock %}
    </body>
</html>